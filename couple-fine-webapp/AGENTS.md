# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds all React code: domain-specific views live in `pages/`, reusable UI in `components/`, shared state in `contexts/`, and Supabase helpers in `lib/` and `utils/`.
- Supabase SQL and seed assets sit in `supabase/migrations/`; keep new migrations timestamped (e.g., `20250930HHMMSS_feature.sql`).
- Shared documentation belongs in `docs/` (architecture, onboarding). Static assets live in `public/` while automated capture artifacts go to `screenshots/` and `test_screenshots/`.

## Build, Test, and Development Commands
- `npm install` resolves Node and Playwright helpers; rerun whenever `package.json` changes.
- `npm run dev` launches the Vite dev server at `http://localhost:5173`.
- `npm run build` performs the TypeScript project build then bundles for Vercel deployment.
- `npm run lint` applies ESLint’s TypeScript + React rules; fix issues before committing.
- `npm run type-check` runs `tsc --noEmit` to catch typing regressions.
- End-to-end checks run with `npx playwright test` (configures `tests/e2e`, spins up the dev server automatically). Use `python test_automation.py` for the dual-browser production smoke suite.

## Coding Style & Naming Conventions
- Use TypeScript with strict typing; prefer explicit interfaces in `src/types/`.
- Components, hooks, and contexts follow PascalCase filenames (`CoupleDashboard.tsx`, `useRealtimeBalance.ts`).
- Keep 2-space indentation and trailing commas as generated by Vite + ESLint. Tailwind utility classes belong inline; extract shared tokens to `src/styles/` or component-level constants when reuse emerges.
- Run `npm run lint` before opening PRs; no Prettier is bundled, so rely on ESLint fixes (`npm run lint -- --fix`).

## Testing Guidelines
- Place Playwright specs under `tests/e2e/**` with suffix `.spec.ts`; group by feature domain (e.g., `auth/login.spec.ts`).
- Snapshot assets and reports output to `test-results/`; clean this directory before committing unless artifacts explain failures.
- For targeted UI regression checks, use `npx playwright test --project="Mobile Chrome" --grep @tag`.
- Python smoke scripts log to `test_results.json`; add new checkpoints using the existing JSON schema.

## Commit & Pull Request Guidelines
- Follow the existing message pattern: leading emoji, scoped summary, and succinct context (e.g., `✨ feat: 핀 잠금 애니메이션 추가`). Use English summaries when touching infrastructure shared with outside teams.
- Commits should stay focused; split schema changes and UI tweaks into separate commits.
- PRs must include: summary bullet list, screenshots or GIFs for UI changes, Supabase migration IDs touched, and any follow-up tasks. Link the relevant issue or TODO doc section when available.

## Environment & Security Tips
- Copy `.env.example` to `.env` and supply Supabase credentials (`VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY`). Never commit populated env files.
- When testing locally with real data, create an isolated Supabase branch and confirm Row-Level Security policies remain intact via the SQL snippets in `docs/rls-troubleshooting.md`.
